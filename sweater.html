<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Sweater</title>
    <link rel="stylesheet" href="css/main.css" media="screen" charset="utf-8">
    <script src="js/jquery.min.js" charset="utf-8"></script>
</head>

<body>
  <div class="loading-bar" id="loading-bar">
    <div class="cccimage">
      <img src="img/ccc.png" class="rotate">
    </div>
  </div>
  <div id="three" style="display: none;"></div>
  <script src="js/three.js" charset="utf-8"></script>
  <script src="js/OrbitControls.js" charset="utf-8"></script>
  <script src="js/DDSLoader.js"></script>
  <script src="js/OBJLoader.js"></script>
  <script src="js/MTLLoader.js"></script>
  <script src="js/OBJMTLLoader.js"></script>
    <script type="text/javascript">
        // Creating variables at one place
        var scene, camera, renderer,
            width, height, light,
            loader, material, mesh;
        var three = document.getElementById("three");

        // methods to call
        $(document).ready(function () {
          setTimeout(function () {
            init();
            animate();
          }, 500);
        });

        // defining methods
        function init() {
            // Creating scene
            scene = new THREE.Scene();
            width = window.innerWidth;
            height = window.innerHeight;

            // Creating renderer
            renderer = new THREE.WebGLRenderer({
              antialias: true,
              alpha: true
            });
            renderer.setSize(width, height);
            three.appendChild(renderer.domElement);
            renderer.setClearColor(0x000000, 1);
            renderer.recieveShadow = true;
            renderer.autoClear = false;

            // Creating camera
            camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 10000);
            camera.position.set(0, 0, 25);
            scene.add(camera);

            // Adding Controls
            var controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableZoom = false;

            // Adding Ambient light and spotlight
            amblight = new THREE.AmbientLight(0x777777);
            scene.add(amblight);

            var spotLight = new THREE.SpotLight(0xffffff);
            spotLight.position.set(1000, 1000, 1000);
            scene.add(amblight);
            camera.add(spotLight);

            // loader = new THREE.JSONLoader();
            // loader.load("js/json/sweater.json", function(geometry) {
            //     var texture2 = new THREE.TextureLoader();
            //     var url = 'img/ball_texture3.jpg';
            //     texture2.load(
            //         url,
            //         function(texture) {
            //             var material = new THREE.MeshPhongMaterial({ color: 0xffffff});
            //             sphere = new THREE.Mesh(geometry, material);
            //             scene.add(sphere);
            //         },
            //         function(xhr) {
            //             console.log((xhr.loaded / xhr.total * 100) + '% loaded');
            //         },
            //         function(xhr) {
            //             console.log('An error happened');
            //         }
            //     );
            // });

            var onProgress = function (xhr) {
    					if (xhr.lengthComputable) {
    						var percentComplete = xhr.loaded / xhr.total * 100;
    					}
    				};
            var onError = function (xhr) {};
    				THREE.Loader.Handlers.add(/\.dds$/i, new THREE.DDSLoader());
    				var loader = new THREE.OBJMTLLoader();
    				loader.load('res/sweater/sweater.obj', 'res/sweater/sweater.mtl', function (object) {
    					scene.add(object);
              console.log("object loaded");
              document.getElementById("loading-bar").style.display = "none";
              document.getElementById("three").style.display = "block";
    				}, onProgress, onError);
        }

        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
    </script>
</body>

</html>
