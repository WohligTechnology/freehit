<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Ball</title>
  <link rel="stylesheet" href="css/main.css" media="screen" title="no title" charset="utf-8">
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.js" charset="utf-8"></script> -->
  <script src="js/jquery.min.js" charset="utf-8"></script>
</head>

<body>
  <script src="js/three.js" charset="utf-8"></script>
  <script src="js/OrbitControls.js" charset="utf-8"></script>
  <script src="js/OBJLoader.js" charset="utf-8"></script>
  <script src="js/TextGeometry.js" charset="utf-8"></script>
  <script src="js/TransformControls.js" charset="utf-8"></script>
  <script src="bower_components/threex.dynamictexture/threex.dynamictexture.js"></script>
  <script type="text/javascript">
    // Creating variables at one place
    var scene, camera, renderer,
      width, height, light,
      loader, material, mesh;

    // methods to call
    init();
    animate();

    // defining methods
    function init() {
      // Creating scene
      scene = new THREE.Scene();
      width = window.innerWidth;
      height = window.innerHeight;

      // Creating renderer
      renderer = new THREE.WebGLRenderer({
        antialias: true,
        alpha: true
      });
      renderer.setSize(width, height);
      document.body.appendChild(renderer.domElement);
      renderer.setClearColor(0xffffff, 1);
      renderer.recieveShadow = true;

      // Creating camera
      camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 10000);
      camera.position.set(0, 4, 8);
      scene.add(camera);

      // Adding Controls
      var controls = new THREE.OrbitControls(camera, renderer.domElement);
      // controls.enableRotate = false;
      controls.enableZoom = false;

      // Updating viewport
      window.addEventListener('resize', function() {
        renderer.setSize(width, height);
        camera.aspect = width / height;
        camera.updateProjectionMatrix();
      });

      // Adding Ambient light
      amblight = new THREE.AmbientLight(0xffffff);
      scene.add(amblight);

      // Adding Directional light
      dirlight = new THREE.DirectionalLight(0xffffff, 0.5);
      dirlight.shadowCameraNear = 1;
      dirlight.shadowCameraFar = 150;
      dirlight.castshadow = true;
      //dirlight.castShadow = true;
      //dirlight.shadowDarkness = 0.5;
      //scene.add(dirlight);

      var spotLight = new THREE.SpotLight(0xffffff);
      spotLight.position.set(1000, 1000, 1000);
      spotLight.castShadow = true;
      camera.add(spotLight);

      //Loading json
      // loader = new THREE.JSONLoader();
      // loader.load('js/ball.js', function(geometry) {
      //   var texture = THREE.ImageUtils.loadTexture("texture.jpg");
      //   texture.wrapS = THREE.RepeatWrapping;
      //   texture.wrapT = THREE.RepeatWrapping;
      //   material = new THREE.MeshBasicMaterial({
      //     map: texture
      //   });
      //   mesh = new THREE.Mesh(geometry, material);
      //   var model = new THREE.Object3D();
      //   model.add(mesh);
      //   // model.scale.set(5, 5, 5);
      //   // model.position.set(-10, -20, 0);
      //   scene.add(model);
      // });

      // DYANMIMC TEXT
      var dynamicTexture  = new THREEx.DynamicTexture(512,512);
      dynamicTexture.texture.needsUpdate = true;



      // var url		= 'img/ball_texture3.jpg';
    	// var image	= document.createElement('img');
    	// image.src	= url;
    	// image.addEventListener('load', function() {
    	// 	dynamicTexture.drawImage(image, 0, 0);
      //   //var textureLoader = new THREE.TextureLoader();
      //   dynamicTexture.drawText('HarsH', 0, 256, 'black');
    	// });

      // Native Sphere
      // var geometry = new THREE.SphereGeometry(1, 50, 50);
      // // var geometry = new THREE.CubeGeometry( 10, 10, 10);
      // var texture2 = new THREE.TextureLoader();
      // var url = 'img/ball_texture3.jpg';
      // texture2.load(
      //   url,
      //   function(texture) {
      //   	var image	= document.createElement('img');
      //   	image.src	= url;
      //   	image.addEventListener('load', function() {
      //   		//dynamicTexture.drawImage(image, 0, 0);
      //       dynamicTexture.drawText('HarsH', 0, 256, 'black');
      //   	});
      //
      //     var mapp = dynamicTexture.texture;
      //     var material1 = new THREE.MeshPhongMaterial({ map: texture });
      //     var material2 = new THREE.MeshPhongMaterial({ map: texture });
      //     //
      //     var materials = [material2,material1];
      //     var meshFaceMaterial = new THREE.MeshFaceMaterial(materials);
      //     var sphere = new THREE.Mesh(geometry, meshFaceMaterial);
      //     sphere.castShadow = true;
      //     sphere.rotation.y = -5.5;
      //     sphere.rotation.z = -1;
      //     scene.add(sphere);
      //   },
      //   function(xhr) {
      //     console.log((xhr.loaded / xhr.total * 100) + '% loaded');
      //   },
      //   function(xhr) {
      //     console.log('An error happened');
      //   }
      // );

      //var texture = THREE.ImageUtils.loadTexture('ball_texture3.jpg');
      loader = new THREE.JSONLoader();
      loader.load('js/ball.json', function(geometry) {
        var texture2 = new THREE.TextureLoader();
        texture2.load(
          'img/ball_texture3.jpg',
          function(texture) {
            var material = new THREE.MeshPhongMaterial({ map: texture });
            var sphere = new THREE.Mesh(geometry, material);
            sphere.castShadow = true;
            sphere.rotation = false;
            scene.add(sphere);
          },
          function(xhr) {
            console.log((xhr.loaded / xhr.total * 100) + '% loaded');
          },
          function(xhr) {
            console.log('An error happened');
          }
        );
      });
    }

    function animate() {
      requestAnimationFrame(animate);
      //mesh.rotation.z += 0.01;
      renderer.render(scene, camera);
    }

    $.getJSON("js/shirt.json", function(json) {
      //console.log(json.materials);
      for (i = 0; i <= 38; i++) {
        //json.materials[i].color = 11316396;
      }
      //console.log(json.materials[0].color);
    });

    var onKeyDown = function(event) {
      if (event.keyCode == 67) { // when 'c' is pressed
        material.color.setHex(0xff0000); // there is also setHSV and setRGB
      } else if (event.keyCode == 68) { // when 'd' is pressed
        material.color.setHex(0x00ff00); // there is also setHSV and setRGB
      } else if (event.keyCode == 69) { // when 'e' is pressed
        material.color.setHex(0x0000ff); // there is also setHSV and setRGB
      }
    };
    document.addEventListener('keydown', onKeyDown, false);
  </script>
</body>

</html>
